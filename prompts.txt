 
Produce detailed documentation about this tableau dashboard using these json files extracted from it. Make the output a markdown file.
 
Include these sections:
 
- Data sources
	- Include data source names and the type of source (csv, txt, database etc)
	- For each data source, produce a table of used fields containing: the fields from that source that are used in charts on the dashboard, if they are a raw field from the source or a calculated one, and how many times each field is used in the dashboard in charts and calculations
	- Produce a similar table for data source fields that are not used in charts on the dashboard containing the field name and if it's a raw/calculated field
 
- Field Details
	- In this section I want a table with 5 columns - Field Name, Field Type (Raw/Calculated Field), Formula (the formula of any calculated fields), Datasource (this could be a data source name or "Parameter" if it's a parameter), and Times_Used (the number of times the field is used on the dashboard)


	

A) Workbook & File Metadata (from the .twb header)

What is the workbook title?

Which Tableau version/build saved the file?

What locale/region settings are stored (if any)?

Is animations enabled/disabled at the workbook level (if present)?



B) Data Sources & Connections (embedded/published references)

What is the data source name/caption? Is it an embedded dataset or published reference? Is it a live connection or an extract?

Which connector/class is used (e.g., bigquery, sqlserver, snowflake, google-sheets)?

What are the connection attributes (server/host, db, schema, table, project/dataset for BigQuery, initial SQL, SSL, etc.)?

Is custom SQL used? If so, what is the SQL text?

Are there data source (row-level) filters defined at the data source?

Is an extract defined? If yes, is it a full or incremental extract? What are the incremental extract keys? Are there any extract filters applied?

Are there joins/unions in the physical layer of the data source physical tables inside logical tables)?

Are there Relationships defined (logical model, 2020.2+)? What are the related tables and clauses?



C) Logical Model & Physical Joins

Which logical tables exist and what are their names/captions?

What relationships are defined between logical tables (join keys/clauses, cardinality/RI if present)?

Within each logical table, what physical joins/unions exist and what are their join types/clauses?



D) Fields, Metadata, Aliases & Grouping

Which fields (columns) are available in each data source and what are their data types and roles (dimension/measure)?

What are the default aggregations and number/date formats for each field?

Which fields have geographic roles (Country, State, etc.) and assigned geographic types?

What aliases exist for discrete values (value remapping)?

Which fields are in hierarchies?

Are fields are in organinised in folders?

Which bins, groups, and sets are defined and how (members/conditions)?



E) Calculated Fields & Table/LOD Logic

Which calculated fields exist and what are their exact formulas?

Which calculations are LOD (FIXED/INCLUDE/EXCLUDE) vs row‑level aggregations?

Which calculations are Table Calculations and what are their addressing/partitioning settings?

What fields/parameters do calcs depend on?



F) Parameters

Which parameters exist (name, data type, allowable values/list/range) and what are their defaults?

Which calculations or fields reference these parameters?



G) Worksheets (Shelves, Marks, Analytics, Tooltips)
Repeat for each worksheet.

What is the worksheet name? Is there any caption text?

Which fields are on Rows, Columns, Pages, Filters, Marks (Color/Size/Label/Detail/Tooltip/Shape), Measure Names/Values?

Which filters are applied, of what type (categorical/range/top/condition) and what are their default selections (include/exclude)?

Which filters are set as context filters?

What is the Marks type (Automatic/Bar/Line/Shape/Map, etc.) and any fixed color/shape mappings?

What are the sort orders and sort types applied to fields on shelves?

Are totals/subtotals, reference lines/bands, trend lines, or forecasts enabled? With what settings?

What are the axis ranges/scales (fixed/automatic, log/linear) and number/date formats?

What is the tooltip content and are there any Viz‑in‑Tooltip sheets referenced?



H) Dashboards (Layout, Zones, Actions, Device Designer)
Repeat for each dashboard.

What is the dashboard name and size behaviour (fixed, range, automatic) with dimensions?

Which worksheets are placed on the dashboard and where (zones/containers)?

Which legends, filter cards, and parameter controls are shown by default on the dashboard?

Which actions exist (Filter, Highlight, URL, Parameter, Set) and what are their source/target sheets and run modes (Select/Hover/Menu)?

Are there navigation buttons or URL actions on the canvas (and their destinations)?

Are there any Extensions embedded? If so, which extension URLs/IDs and zone settings?

What device layouts exist (desktop/tablet/phone) and which zones are overridden per device?


 



My goal now is to create a Documentation file from a Tableau Dashboard file. My directory is 'tableau_doc'. The Tableau Dashboard file is a '.txb' file which has a XML
structure and I have one located at 'tableau_doc/Superstore.twb' This file must not be changed. Before trying to create a documentation using a LLM I would like to create a
python script to extract as much information as possible from the  '.twb' file and then summarise this into an auxiliar .json file file. This .json file alongside the '.txb' file would be used to finally generate the Tableau Dashboard documentation.

The Python Script should be generic i.e. being able to extract entities from any '.twb' file.

The information extracted by the python script should contain enough information to answer all the questions below

A) Workbook & File Metadata (from the .twb header)

What is the workbook title?

Which Tableau version/build saved the file?

What locale/region settings are stored (if any)?

Is animations enabled/disabled at the workbook level (if present)?



B) Data Sources & Connections (embedded/published references)

What is the data source name/caption? Is it an embedded dataset or published reference? Is it a live connection or an extract?

Which connector/class is used (e.g., bigquery, sqlserver, snowflake, google-sheets)?

What are the connection attributes (server/host, db, schema, table, project/dataset for BigQuery, initial SQL, SSL, etc.)?

Is custom SQL used? If so, what is the SQL text?

Are there data source (row-level) filters defined at the data source?

Is an extract defined? If yes, is it a full or incremental extract? What are the incremental extract keys? Are there any extract filters applied?

Are there joins/unions in the physical layer of the data source physical tables inside logical tables)?

Are there Relationships defined (logical model, 2020.2+)? What are the related tables and clauses?



C) Logical Model & Physical Joins

Which logical tables exist and what are their names/captions?

What relationships are defined between logical tables (join keys/clauses, cardinality/RI if present)?

Within each logical table, what physical joins/unions exist and what are their join types/clauses?



D) Fields, Metadata, Aliases & Grouping

Which fields (columns) are available in each data source and what are their data types and roles (dimension/measure)?

What are the default aggregations and number/date formats for each field?

Which fields have geographic roles (Country, State, etc.) and assigned geographic types?

What aliases exist for discrete values (value remapping)?

Which fields are in hierarchies?

Are fields are in organinised in folders?

Which bins, groups, and sets are defined and how (members/conditions)?



E) Calculated Fields & Table/LOD Logic

Which calculated fields exist and what are their exact formulas?

Which calculations are LOD (FIXED/INCLUDE/EXCLUDE) vs row‑level aggregations?

Which calculations are Table Calculations and what are their addressing/partitioning settings?

What fields/parameters do calcs depend on?



F) Parameters

Which parameters exist (name, data type, allowable values/list/range) and what are their defaults?

Which calculations or fields reference these parameters?



G) Worksheets (Shelves, Marks, Analytics, Tooltips)
Repeat for each worksheet.

What is the worksheet name? Is there any caption text?

Which fields are on Rows, Columns, Pages, Filters, Marks (Color/Size/Label/Detail/Tooltip/Shape), Measure Names/Values?

Which filters are applied, of what type (categorical/range/top/condition) and what are their default selections (include/exclude)?

Which filters are set as context filters?

What is the Marks type (Automatic/Bar/Line/Shape/Map, etc.) and any fixed color/shape mappings?

What are the sort orders and sort types applied to fields on shelves?

Are totals/subtotals, reference lines/bands, trend lines, or forecasts enabled? With what settings?

What are the axis ranges/scales (fixed/automatic, log/linear) and number/date formats?

What is the tooltip content and are there any Viz‑in‑Tooltip sheets referenced?



H) Dashboards (Layout, Zones, Actions, Device Designer)
Repeat for each dashboard.

What is the dashboard name and size behaviour (fixed, range, automatic) with dimensions?

Which worksheets are placed on the dashboard and where (zones/containers)?

Which legends, filter cards, and parameter controls are shown by default on the dashboard?

Which actions exist (Filter, Highlight, URL, Parameter, Set) and what are their source/target sheets and run modes (Select/Hover/Menu)?

Are there navigation buttons or URL actions on the canvas (and their destinations)?

Are there any Extensions embedded? If so, which extension URLs/IDs and zone settings?

What device layouts exist (desktop/tablet/phone) and which zones are overridden per device?


Now generate the python script and store it in 'tableau_doc/src_v2'

- Keep Clean Code in Mind
- Always include to the parameter name when calling functions
- Always add type hints to function definitions
- Focus on modularity. Break it down into separate files for clarity. 
- Make sure all these arguments and parameters of the python script are controlled by a config (.yaml) file. Using Munch library is prefered.
- Remember the Tableau file is at `tableau_doc/Superstore.twb` and it must not be changed.
- The output of the python script should be stored at `tableau_doc/output` (Configurable, should be in the config.yaml file)